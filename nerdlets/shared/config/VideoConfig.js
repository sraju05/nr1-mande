import { USER_IDENTIFIER, VIDEO_EVENTS } from './constants'

const defaultToOne = metric => {
  return metric !== undefined ? metric : 1
}

export default {
  title: 'Video',
  eventTypes: [
    {
      event: 'Global',
      attributes: [
        ['appName', 'Platform'],
        ['appVersion', 'Platform'],
        ['playerVersion', 'Platform'],
        ['playerName', 'Platform'],
        ['countryCode', 'Geography'],
        ['assetName', 'Content'],
        ['userAgentName', 'Platform'],
        ['userAgentOS', 'Platform'],
        ['userAgentVersion', 'Platform'],
        ['asnOrganization', 'Geography'],
        ['asnOwner', 'Geography'],
        ['BDUName', 'Geography'],
        ['city', 'Geography'],
        ['regionCode', 'Geography'],
        ['errorMessage', 'Error'],
        ['deviceId', 'Platform'],
        ['deviceModel', 'Platform'],
        ['deviceGroup', 'Platform'],
        ['deviceType', 'Platform'],
        ['osName', 'Platform'],
        ['osVersion', 'Platform'],
        ['userId', 'User'],
        ['userAisuid', 'User'],
        ['capiProvider', 'Content'],
        ['streamFormat', 'Content'],
        ['immersiveActiveCamera', 'Content'],
        ['drm', 'Content'],
        ['drmType', 'Content'],
        ['trackerName', 'Platform'],
        ['trackerVersion', 'Platform'],
        ['coreVersion', 'Platform'],
        ['playMethod', 'Content'],
        ['playbackMethod', 'Content'],
      ],
    },
    {
      event: 'PageAction',
      attributes: [],
    },
    {
      event: 'MobileVideo',
      attributes: [],
    },
    {
      event: 'RokuVideo',
      attributes: [],
    },
    {
      event: 'BrowserVideo',
      attributes: [],
    },
  ],
  metrics: [
    {
      id: 'VST',
      title: 'Video Start Time',
      threshold: {
        critical: 5,
        warning: 4,
      },
      query: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'result' `,
        lookup: 'result',
        title: 'Video Start Time (Avg)',
      },
      findUser: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT (clamp_min(filter(sum(timeSinceRequested/1000), WHERE actionName = 'CONTENT_START'  and timeSinceContentManifestRequest < 90000), 0) - clamp_min(filter(sum(timeSinceAdBreakBegin/1000), where actionName = 'AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL), 0)) / filter(uniqueCount(viewId), where actionName='CONTENT_START') as 'result' `,
        lookup: 'result',
      },
      qualityScoreStrategy: 'clampMinZeroMaxOne',
      detailDashboardId: 'VST-Detail',
    },
    {
      id: 'CRR',
      title: 'Connection Buffering Ratio',
      threshold: {
        critical: 0.5,
        warning: 0.3,
      },
      query: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as 'result' where playerName != '4D Player' `,
        lookup: 'result',
      },
      qualityScoreStrategy: 'clampMinZeroMaxOne',
      detailDashboardId: 'Buffering-Detail',
    },
    {
      id: 'CBT',
      title: 'Total Connection Buffering Time',
      query: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(timeSinceBufferBegin/1000), WHERE actionName = 'CONTENT_BUFFER_END' AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000) - filter(sum(timeSinceBufferBegin/1000), where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true))+filter(sum(timeSinceBufferBegin/1000), where bufferType = 'connection' and playerName = 'NexPlayer' and timeSinceStarted > 10000) as 'result' where playerName != '4D Player' `,
        lookup: 'result',
      },
      detailDashboardId: 'Buffering-Detail',
    },
    {
      id: 'VSF',
      title: 'Video Start Failure %',
      threshold: {
        critical: 100,
        warning: 99,
      },
      query: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 'result' `,
        lookup: 'result',
      },
      qualityScoreStrategy: 'zeroOrOne',
      detailDashboardId: 'VSF-Detail',
    },
    {
      id: 'ER',
      title: 'Video Playback Failure %',
      query: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as 'result' `,
        lookup: 'result',
      },
      findUser: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT filter(clamp_max(count(*), 1), where actionName = 'CONTENT_ERROR' and totalPlaytime >= 1000) / filter(clamp_max(count(*), 1), where actionName = 'CONTENT_REQUEST') * 100 as 'result' `,
        lookup: 'result',
      },
      qualityScoreStrategy: 'clampMinZeroMaxOne',
      detailDashboardId: 'ER-Detail',
    },
    {
      id: 'BR',
      title: 'Average Bitrate (mbps)',
      invertCompareTo: 'true',
      query: {
        nrql: `SELECT sum(bitrate) / sum(number) as 'result' from (select (filter(sum(MobileVideo.contentBitrate)/1000/1000, where appName like '%iOS%' or appName like '%tvOS%') + filter(sum(MobileVideo.contentBitrate)/8/1000/1000, where appName like '%Android%') + filter(sum(PageAction.contentRenditionBitrate)/1000/1000, where appName like 'Crave%')) as 'bitrate', count(*) as 'number' from ${VIDEO_EVENTS} facet appVersion limit max timeseries)`,
        lookup: 'result',
      },
      detailDashboardId: 'BR-Detail',
    },
    {
      id: 'FPS',
      title: 'Frames Per Second',
      invertCompareTo: 'true',
      query: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'result' `,
        lookup: 'result',
      },
      detailDashboardId: 'FPS-Detail',
    },
    {
      id: 'FD',
      title: 'Frame Drops',
      query: {
        nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(droppedFrames), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'result' `,
        lookup: 'result',
      },
      detailDashboardId: 'FPS-Detail',
    },
  ],
  overviewDashboard: [
    {
      nrql: `SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'Seconds' FROM ${VIDEO_EVENTS} TIMESERIES LIMIT 25 `,
      columnStart: 1,
      columnEnd: 4,
      chartSize: 'small',
      chartType: 'line',
      title: 'Video Start Time Trend',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as '%' TIMESERIES LIMIT 25 `,
      columnStart: 5,
      columnEnd: 8,
      chartSize: 'small',
      chartType: 'line',
      title: 'Video Start Failure Trend',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
      columnStart: 9,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'line',
      title: 'Video Playback Failure Trend',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
      columnStart: 1,
      columnEnd: 4,
      chartSize: 'small',
      chartType: 'line',
      title: 'Connection Buffering Ratio Trend',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
      columnStart: 5,
      columnEnd: 8,
      chartSize: 'small',
      chartType: 'line',
      title: 'Timeslice Average FPS',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(droppedFrames), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'Frames Dropped' TIMESERIES LIMIT 25 `,
      columnStart: 9,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'line',
      title: 'Frame Drops',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName = 'CONTENT_START' and playerName !='NexPlayer') + filter(uniqueCount(viewId, assetName), where actionName = 'CONTENT_START' and playerName = 'NexPlayer')- filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND timeSinceStarted > 0 AND timeSinceStarted < 5000) as 'Plays' TIMESERIES LIMIT 25 `,
      columnStart: 1,
      columnEnd: 6,
      chartSize: 'small',
      chartType: 'line',
      title: 'Plays Trend',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(playtimeSinceLastEvent/1000/60), where contentPlayhead !=0 and playMethod NOT IN ('multiview', 'timeslice')) - filter(sum(timeSincePaused/1000/60), where action = 'CONTENT_RESUME' and playMethod NOT IN ('multiview', 'timeslice')) - filter(sum(timeSinceBufferBegin/1000/60), where actionName = 'CONTENT_BUFFER_END' and bufferType = 'seek' and playMethod NOT IN ('multiview', 'timeslice')) - filter(sum(timeSinceBufferBegin/1000/60), where actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and playMethod NOT IN ('multiview', 'timeslice')) - filter(sum(timeSinceBackground/1000/60), where actionName = 'FOREGROUND' and contentplayhead > 0 and playMethod NOT IN ('multiview', 'timeslice'))) + filter(sum(playtimeSinceLastEvent/1000/60), where contentPlayhead !=0 and playMethod IN ('multiview', 'timeslice')) as 'minutes' TIMESERIES LIMIT 25 `,
      columnStart: 7,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'line',
      title: 'Playtime Trend',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
      facets: 'appName',
      columnStart: 1,
      columnEnd: 4,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Time Trend by App',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
      facets: 'city, regionCode',
      columnStart: 5,
      columnEnd: 8,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Time Trend by City/Region Code',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
      facets: 'asnOwner,asnOrganization',
      columnStart: 9,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Time Trend by ISP Owner/Org',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
      facets: 'assetName',
      columnStart: 1,
      columnEnd: 6,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Time Trend by Asset Name',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'Seconds' TIMESERIES limit 50 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown')`,
      noFacet: true,
      columnStart: 7,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title:
        'Video Start Time Trend by Video Domain (Capi Provider) - No Click',
      useSince: true,
      click: 'doNothing',
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
      '%' TIMESERIES LIMIT 25 `,
      facets: 'appName',
      columnStart: 1,
      columnEnd: 4,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Failure Trend by App',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
      '%' TIMESERIES LIMIT 25 `,
      facets: 'city,regionCode',
      columnStart: 5,
      columnEnd: 8,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Failure Trend by City/Region Code',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
      '%' TIMESERIES LIMIT 25 `,
      facets: 'asnOwner,asnOrganization',
      columnStart: 9,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Failure Trend by ISP Owner/Org',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
      '%' TIMESERIES LIMIT 25 `,
      facets: 'assetName',
      columnStart: 1,
      columnEnd: 6,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Start Failure Trend by Asset Name',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as '%' TIMESERIES limit 25 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown') `,
      noFacet: true,
      columnStart: 7,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title:
        'Video Start Failure Trend by Video Domain (Capi Provider) - No Click',
      useSince: true,
      click: 'doNothing',
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
      facets: 'appName',
      columnStart: 1,
      columnEnd: 4,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Playback Failure Trend by App',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
      facets: 'city,regionCode',
      columnStart: 5,
      columnEnd: 8,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Playback Failure Trend by City/Region Code',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
      facets: 'asnOwner,asnOrganization',
      columnStart: 9,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Playback Failure Trend by ISP Owner/Org',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
      facets: 'assetName',
      columnStart: 1,
      columnEnd: 6,
      chartSize: 'small',
      chartType: 'area',
      title: 'Video Playback Failure Trend by Asset Name',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES limit 25 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown') `,
      noFacet: true,
      columnStart: 7,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title:
        'Video Playback Failure Trend by Video Domain (Capi Provider) - No Click',
      useSince: true,
      click: 'doNothing',
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
      facets: 'appName',
      columnStart: 1,
      columnEnd: 4,
      chartSize: 'small',
      chartType: 'area',
      title: 'Connection Buffering Ratio Trend by App',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
      facets: 'city, regionCode',
      columnStart: 5,
      columnEnd: 8,
      chartSize: 'small',
      chartType: 'area',
      title: 'Connection Buffering Ratio Trend by City/Region Code',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
      facets: 'asnOwner,asnOrganization',
      columnStart: 9,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title: 'Connection Buffering Ratio Trend by ISP Owner/Org',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
      facets: 'assetName',
      columnStart: 1,
      columnEnd: 6,
      chartSize: 'small',
      chartType: 'area',
      title: 'Connection Buffering Ratio Trend by Asset Name',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES limit 25 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown') `,
      noFacet: true,
      columnStart: 7,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title:
        'Connection Buffering Ratio Trend by Video Domain (Capi Provider) - No Click',
      useSince: true,
      click: 'doNothing',
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
      facets: 'appName',
      columnStart: 1,
      columnEnd: 4,
      chartSize: 'small',
      chartType: 'area',
      title: 'Average FPS Trend by App',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
      facets: 'city, regionCode',
      columnStart: 5,
      columnEnd: 8,
      chartSize: 'small',
      chartType: 'area',
      title: 'Average FPS Trend by City/Region Code',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
      facets: 'asnOwner,asnOrganization',
      columnStart: 9,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title: 'Average FPS Trend by ISP Owner/Org',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
      facets: 'assetName',
      columnStart: 1,
      columnEnd: 6,
      chartSize: 'small',
      chartType: 'area',
      title: 'Average FPS Trend by Asset Name',
      useSince: true,
    },
    {
      nrql: `FROM ${VIDEO_EVENTS} SELECT average(contentFps) where contentFps != 0 and trackerName = 'TimeSliceTracker' TIMESERIES LIMIT 25 `,
      facets: 'capiProvider',
      columnStart: 7,
      columnEnd: 12,
      chartSize: 'small',
      chartType: 'area',
      title: 'Average FPS Trend by Video Domain',
      useSince: true,
      // click: 'doNothing',
    },
  ],
  detailDashboards: [
    {
      id: 'VST-Detail',
      config: [
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'Seconds' `,
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Average Video Start Time',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'Seconds' TIMESERIES `,
          columnStart: 5,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'Video Start Time',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT percentage(uniqueCount(${USER_IDENTIFIER}), where timeSinceContentManifestRequest > 5000 and timeSinceContentManifestRequest < 90000 and actionName = 'CONTENT_START') `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VST % Customer Impact > 5 seconds',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName = 'CONTENT_START' and playerName !='NexPlayer') + filter(uniqueCount(viewId, assetName), where actionName = 'CONTENT_START' and playerName = 'NexPlayer')- filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND timeSinceStarted > 0 AND timeSinceStarted < 5000) as 'Plays' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Video Plays',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(count(viewId), where timeSinceContentManifestRequest < 5000 and timeSinceContentManifestRequest < 90000 AND actionName = 'CONTENT_START' ) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(count(viewId), WHERE actionName = 'CONTENT_START' and timeSinceContentManifestRequest is not NULL) *100 as'%' `,
          columnStart: 7,
          columnEnd: 9,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VST Under 5 Seconds',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(${USER_IDENTIFIER}) as 'Customers' where timeSinceContentManifestRequest > 5000 and timeSinceContentManifestRequest < 90000 and actionName = 'CONTENT_START' `,
          columnStart: 10,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VST Customer Impact > 5 seconds',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT percentage(uniqueCount(${USER_IDENTIFIER}), where timeSinceContentManifestRequest > 5000 and timeSinceContentManifestRequest < 90000 and actionName = 'CONTENT_START') as 'Percentage' TIMESERIES `,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'line',
          title: 'VST % Customer Impact > 5 seconds Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName = 'CONTENT_START' and playerName !='NexPlayer') + filter(uniqueCount(viewId, assetName), where actionName = 'CONTENT_START' and playerName = 'NexPlayer')- filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND timeSinceStarted > 0 AND timeSinceStarted < 5000) as 'Plays' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: 'Plays Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(count(viewId), where timeSinceContentManifestRequest < 5000 and timeSinceContentManifestRequest < 90000 AND actionName = 'CONTENT_START' ) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(count(viewId), WHERE actionName = 'CONTENT_START' and timeSinceContentManifestRequest is not NULL) *100 as 'Percentage' TIMESERIES `,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'line',
          title: 'VST < 5 seconds Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(${USER_IDENTIFIER}) as 'Customers' where timeSinceContentManifestRequest > 5000 and timeSinceContentManifestRequest < 90000 and actionName = 'CONTENT_START' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: 'VST Customer Impact > 5 seconds Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
          facets: 'appName',
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'area',
          title: 'Video Start Time Trend by App',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
          facets: 'city, regionCode',
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'Video Start Time Trend by City/Region Code',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
          facets: 'asnOwner,asnOrganization',
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Video Start Time Trend by ISP Owner/Org',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'seconds' TIMESERIES LIMIT 25 `,
          facets: 'assetName',
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'area',
          title: 'Video Start Time Trend by Asset Name',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) / filter(uniqueCount(viewId, assetName) , where actionName = 'CONTENT_START' and timeSinceContentManifestRequest IS NOT NULL) as 'Seconds' TIMESERIES limit 50 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown')`,
          noFacet: true,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title:
            'Video Start Time Trend by Video Domain (Capi Provider) - No Click',
          useSince: true,
          click: 'doNothing',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(percentile(timeSinceContentManifestRequest/1000, 50, 90, 95, 99), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000 and (timeSinceBackground is NULL OR timeSinceBackground <1000)) as 'Seconds' `,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 2,
          chartSize: 'small',
          chartType: 'billboard',
          title: 'Start Time Percentile',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(percentile(timeSinceContentManifestRequest/1000, 50, 90, 95, 99), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000 and (timeSinceBackground is NULL OR timeSinceBackground <1000)) as 'Seconds' TIMESERIES `,
          noFacet: 'true',
          columnStart: 3,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'line',
          title: 'Start Time Percentile Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceContentManifestRequest/1000), where actionName = 'CONTENT_START' and timeSinceContentManifestRequest < 90000) - filter(sum(timeSinceAdBreakBegin/1000), where actionName ='AD_BREAK_END' and adPosition = 'pre' and timeSinceContentManifestRequest is NOT NULL)) FACET viewId LIMIT 200`,
          noFacet: true,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'bar',
          title: 'Views, Average Video Start Time (Click for details)',
          useSince: true,
          click: 'openSession',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT actionName, timeSinceContentManifestRequest, timeSinceBackground, assetId, assetName, aisuid, viewId, appName, appVersion, capiProvider, city, regionCode, asnOrganization, asnOwner, deviceModel, osName, osVersion, playerName, playerVersion, userAgentOS, userAgentName where actionName = 'CONTENT_START' and timeSinceContentManifestRequest >5000 and timeSinceContentManifestRequest < 60000 LIMIT MAX`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'large',
          chartType: 'table',
          title: 'Events Log - VST > 5 seconds',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT * where actionName != 'CONTENT_HEARTBEAT' LIMIT MAX`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'table',
          title: 'Latest Events Log',
          useSince: true,
        },
      ],
    },
    {
      id: 'VSF-Detail',
      config: [
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) *100 as '%' `,
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VSF %',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) *100 as '%' TIMESERIES `,
          columnStart: 5,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'VSF % Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000) as 'Start Failures' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Total Start Failures',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT count(*) as 'Attempts' where actionName = 'CONTENT_REQUEST' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Play Attempts',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000) as'Impacted' `,
          columnStart: 7,
          columnEnd: 9,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VSF Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000) / filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_START' or totalPlaytime < 1000) as'%' `,
          columnStart: 10,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VSF % Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000) as'Start Failures' TIMESERIES `,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'line',
          title: 'Total Start Failure Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT count(*) as 'Attempts' where actionName = 'CONTENT_REQUEST' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: 'Play Attempts Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000) as'Impacted Customers' TIMESERIES `,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'line',
          title: 'VSF Customer Impact Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000) / filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_START' or totalPlaytime < 1000) as'%' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: 'VSF % Customer Impact Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
          '%' TIMESERIES LIMIT 25 `,
          facets: 'appName',
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'area',
          title: 'VSF % Trend by App',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
          '%' TIMESERIES LIMIT 25 `,
          facets: 'city,regionCode',
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'VSF % Trend by City/Region Code',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
          '%' TIMESERIES LIMIT 25 `,
          facets: 'asnOwner,asnOrganization',
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'VSF % Trend by ISP Owner/Org',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as 
          '%' TIMESERIES LIMIT 25 `,
          facets: 'assetName',
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'area',
          title: 'VSF % Trend by Asset Name',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime < 1000) / filter(count(*), where actionName = 'CONTENT_REQUEST')) * 100 as '%' TIMESERIES limit 25 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown') `,
          noFacet: true,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'VSF % Trend by Video Domain (Capi Provider) - No Click',
          useSince: true,
          click: 'doNothing',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) where totalPlaytime < 1000 `,
          facets: ' errorCode, errorDomain, errorMessage',
          columnStart: 1,
          columnEnd: 7,
          chartSize: 'medium',
          chartType: 'bar',
          title: 'Top Start Failure Messages',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000 facet viewId LIMIT 200`,
          noFacet: 'true',
          columnStart: 8,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'bar',
          title: 'Failures by viewId (Click for details)',
          useSince: true,
          click: 'openSession',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT actionName, errorCode, errorDomain, errorMessage, assetId, assetName, aisuid, appName, appVersion, BDUName, bduName, capiProvider, city, regionCode, asnOrganization, asnOwner, deviceModel, osName, osVersion, playerName, playerVersion, userAgentOS, userAgentName, senderAppName, senderAppVersion, senderUserAgent where actionName = 'CONTENT_ERROR' and totalPlaytime < 1000 LIMIT MAX`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'large',
          chartType: 'table',
          title: 'Start Failure Errors Log',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT * where actionName != 'CONTENT_HEARTBEAT' LIMIT 1000`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'table',
          title: 'All Video Events Log',
          useSince: true,
        },
      ],
    },
    {
      id: 'ER-Detail',
      config: [
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) *100 as '%' `,
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VPF %',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES `,
          columnStart: 5,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'VPF % Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000) as'Playback Failures' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Total Playback Failures',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT count(*) as 'Plays' where actionName = 'CONTENT_START' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Plays',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000) as'Impacted Customers' `,
          columnStart: 7,
          columnEnd: 9,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VPF Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000) / filter(uniqueCount(${USER_IDENTIFIER}), where totalPlaytime > 1000) as '%' `,
          columnStart: 10,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'VPF % Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000) as'Playback Failures' TIMESERIES `,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'line',
          title: 'Playback Failure Trend',
          useSince: true,
        },
        {
          nrql: `SELECT uniqueCount(viewId) as 'Active Plays' FROM ${VIDEO_EVENTS} where totalPlaytime > 1000 TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: 'Plays Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000) as'Playback Failures' TIMESERIES `,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'area',
          title: 'Customer Impact Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000) / filter(uniqueCount(${USER_IDENTIFIER}), where totalPlaytime > 1000) as'%' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Customer Impact % Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
          facets: 'appName',
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'area',
          title: 'VPF % Trend by App',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
          facets: 'city,regionCode',
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'VPF %  Trend by City/Region Code',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
          facets: 'asnOwner,asnOrganization',
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'VPF %  Trend by ISP Owner/Org',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES LIMIT 25 `,
          facets: 'assetName',
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'area',
          title: 'VPF % Trend by Asset Name',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniqueCount(viewId), where actionName = 'CONTENT_ERROR' AND totalPlaytime > 1000) / filter(uniqueCount(viewId), where totalPlaytime > 1000)) * 100 as '%' TIMESERIES limit 25 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown') `,
          noFacet: true,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'VPF % Trend by Video Domain (Capi Provider) - No Click',
          useSince: true,
          click: 'doNothing',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) where totalPlaytime > 1000 `,
          facets: ' errorCode, errorDomain, errorMessage',
          columnStart: 1,
          columnEnd: 7,
          chartSize: 'medium',
          chartType: 'bar',
          title: 'Top Playback Errors',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000 facet viewId LIMIT 200`,
          noFacet: true,
          columnStart: 8,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'bar',
          title: 'Playback Failure by viewId (Click for details)',
          useSince: true,
          click: 'openSession',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT actionName, errorCode, errorDomain, errorMessage, assetId, assetName, aisuid, appName, appVersion, BDUName, bduName, capiProvider, city, regionCode, asnOrganization, asnOwner, deviceModel, osName, osVersion, playerName, playerVersion, userAgentOS, userAgentName where actionName = 'CONTENT_ERROR' and totalPlaytime > 1000 LIMIT MAX`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'large',
          chartType: 'table',
          title: 'Playback Failure Errors Log',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT * where actionName != 'CONTENT_HEARTBEAT' LIMIT 1000`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'table',
          title: 'All Video Events Log',
          useSince: true,
        },
      ],
    },
    {
      id: 'Buffering-Detail',
      config: [
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' `,
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'CIRR',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) as 'Plays' where totalPlaytime > 1000 where trackerName != 'TimeSliceTracker' `,
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Total Plays',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniquecount(viewId), where playerName != 'NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 AND timeSinceBufferBegin > 500 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false)) + filter(uniqueCount(viewId), where playerName = 'NexPlayer' and bufferType = 'connection' and timeSinceStarted > 10000 and timeSinceBufferBegin > 500)) / filter(uniquecount(viewId), where totalPlaytime > 1000)* 100 as '%' where trackerName != 'TimeSliceTracker' `,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'billboard',
          title: '% Plays with CIRR > 500ms',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniquecount(${USER_IDENTIFIER}) as 'Impacted Customers' where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 AND timeSinceBufferBegin > 500 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false) where trackerName != 'TimeSliceTracker' `,
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'CIRR Customer Impact > 500ms',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT percentage(uniquecount(${USER_IDENTIFIER}), where bufferType = 'connection' and timeSinceStarted > 10000 AND timeSinceBufferBegin > 500 and timeSinceBufferBegin < 90000 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false)) as '%' where trackerName != 'TimeSliceTracker' `,
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'micro',
          chartType: 'billboard',
          title: '% CIRR Customers Impacted > 500ms',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(timeSinceBufferBegin/1000), WHERE actionName = 'CONTENT_BUFFER_END' AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000) - filter(sum(timeSinceBufferBegin/1000), where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true)) + filter(sum(timeSinceBufferBegin/1000), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000) as 'seconds' where trackerName != 'TimeSliceTracker' `,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Total Buffer Seconds',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' timeseries auto where trackerName != 'TimeSliceTracker'`,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'area',
          title: 'CIRR Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(uniquecount(viewId), where playerName != 'NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 AND timeSinceBufferBegin > 500 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false)) + filter(uniqueCount(viewId), where playerName = 'NexPlayer' and bufferType = 'connection' and timeSinceStarted > 10000 and timeSinceBufferBegin > 500)) / filter(uniquecount(viewId), where totalPlaytime > 1000)* 100 as '%' where trackerName != 'TimeSliceTracker' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: '% Plays with CIRR > 500ms',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniquecount(${USER_IDENTIFIER}) as 'Impacted Customers' where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 AND timeSinceBufferBegin > 500 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false) where trackerName != 'TimeSliceTracker' TIMESERIES`,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'line',
          title: 'CIRR Customer Impact Trend > 500ms',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT percentage(uniquecount(${USER_IDENTIFIER}), where bufferType = 'connection' and timeSinceStarted > 10000 AND timeSinceBufferBegin > 500 and timeSinceBufferBegin < 90000 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false)) as '%' where trackerName != 'TimeSliceTracker' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: '% Customers Impacted Trend CIRR > 500ms',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
          facets: 'appName',
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'area',
          title: 'Connection Buffering Ratio Trend by App',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
          facets: 'city, regionCode',
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'Connection Buffering Ratio Trend by City/Region Code',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
          facets: 'asnOwner,asnOrganization',
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Connection Buffering Ratio Trend by ISP Owner/Org',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 `,
          facets: 'assetName',
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'area',
          title: 'Connection Buffering Ratio Trend by Asset Name',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where playerName !='NexPlayer' and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + filter(sum(timeSinceBufferBegin), where playerName = 'NexPlayer' and bufferType = 'connection' AND timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' where playerName != '4D Player' TIMESERIES LIMIT 25 facet cases(where capiProvider like '%u1.video%' as 'u1' , where capiProvider like '%ustg.video%' as 'ustg', where capiProvider like '%pe-ak-vp01a%' as 'pe-ak-vp01a', where capiProvider like '%pe-ak-vp02a%' as 'pe-ak-vp02a', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04a%' as 'pe-ak-vp04a', where capiProvider like '%pe-ak-vp05a%' as 'pe-ak-vp05a', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07a%' as 'pe-ak-vp07a', where capiProvider like '%pe-ak-vp08a%' as 'pe-ak-vp08a', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10a%' as 'pe-ak-vp10a', where capiProvider like '%pe-ak-vp11a%' as 'pe-ak-vp11a', where capiProvider like '%pe-ak-vp12a%' as 'pe-ak-vp12a', where capiProvider like '%pe-ak-vp01b%' as 'pe-ak-vp01b', where capiProvider like '%pe-ak-vp02b%' as 'pe-ak-vp02b', where capiProvider like '%pe-ak-vp03a%' as 'pe-ak-vp03a', where capiProvider like '%pe-ak-vp04b%' as 'pe-ak-vp04b', where capiProvider like '%pe-ak-vp05b%' as 'pe-ak-vp05b', where capiProvider like '%pe-ak-vp06a%' as 'pe-ak-vp06a', where capiProvider like '%pe-ak-vp07b%' as 'pe-ak-vp07b', where capiProvider like '%pe-ak-vp08b%' as 'pe-ak-vp08b', where capiProvider like '%pe-ak-vp09a%' as 'pe-ak-vp09a', where capiProvider like '%pe-ak-vp10b%' as 'pe-ak-vp10b', where capiProvider like '%pe-ak-vp11b%' as 'pe-ak-vp11b', where capiProvider like '%pe-ak-vp12b%' as 'pe-ak-vp12b', where capiProvider like '%pe-ak-lp01a%' as 'pe-ak-lp01a', where capiProvider like '%pe-ak-lp02a%' as 'pe-ak-lp02a', where capiProvider like '%pe-ak-lp03a%' as 'pe-ak-lp03a', where capiProvider like '%pe-ak-lp04a%' as 'pe-ak-lp04a', where capiProvider like '%pe-fa-vp01a%' as 'pe-fa-vp01a', where capiProvider like '%pe-fa-vp02a%' as 'pe-fa-vp02a', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04a%' as 'pe-fa-vp04a', where capiProvider like '%pe-fa-vp05a%' as 'pe-fa-vp05a', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07a%' as 'pe-fa-vp07a', where capiProvider like '%pe-fa-vp08a%' as 'pe-fa-vp08a', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10a%' as 'pe-fa-vp10a', where capiProvider like '%pe-fa-vp11a%' as 'pe-fa-vp11a', where capiProvider like '%pe-fa-vp12a%' as 'pe-fa-vp12a', where capiProvider like '%pe-fa-vp01b%' as 'pe-fa-vp01b', where capiProvider like '%pe-fa-vp02b%' as 'pe-fa-vp02b', where capiProvider like '%pe-fa-vp03a%' as 'pe-fa-vp03a', where capiProvider like '%pe-fa-vp04b%' as 'pe-fa-vp04b', where capiProvider like '%pe-fa-vp05b%' as 'pe-fa-vp05b', where capiProvider like '%pe-fa-vp06a%' as 'pe-fa-vp06a', where capiProvider like '%pe-fa-vp07b%' as 'pe-fa-vp07b', where capiProvider like '%pe-fa-vp08b%' as 'pe-fa-vp08b', where capiProvider like '%pe-fa-vp09a%' as 'pe-fa-vp09a', where capiProvider like '%pe-fa-vp10b%' as 'pe-fa-vp10b', where capiProvider like '%pe-fa-vp11b%' as 'pe-fa-vp11b', where capiProvider like '%pe-fa-vp12b%' as 'pe-fa-vp12b', where capiProvider like '%pe-fa-lp01a%' as 'pe-fa-lp01a', where capiProvider like '%pe-fa-lp02a%' as 'pe-fa-lp02a', where capiProvider like '%pe-fa-lp03a%' as 'pe-fa-lp03', where capiProvider like '%pe-fa-lp04a%' as 'pe-fa-lp04a', where capiProvider like '%capi%' as 'CAPI', where capiProvider is NULL as 'Unknown') `,
          noFacet: true,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title:
            'Connection Buffering Ratio Trend by Video Domain (Capi Provider) - No Click',
          useSince: true,
          click: 'doNothing',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END' AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000) - filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END'AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true)) + filter(count(*), where playerName ='NexPlayer' and actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and timeSinceStarted > 10000) as 'Buffer Events' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'small',
          chartType: 'billboard',
          title: 'CIRR Events',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END' AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000) - filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END'AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true)) + filter(count(*), where playerName ='NexPlayer' and actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and timeSinceStarted > 10000) as 'Buffer Events' TIMESERIES where trackerName != 'TimeSliceTracker' `,
          columnStart: 4,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'CIRR Events Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin), where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END')) / (filter(sum(timeSinceBufferBegin), where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END') - filter(sum(timeSinceBufferBegin), where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true) and actionName = 'CONTENT_BUFFER_END') + sum(playtimeSinceLastEvent)) * 100 as '%' FACET viewId LIMIT 200 `,
          noFacet: true,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'bar',
          title: 'viewIds with high CIRR (Click for details)',
          useSince: true,
          click: 'openSession',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin/1000), where playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END'and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 AND (timeSinceResumed > 10000 OR timeSinceResumed IS NULL) AND (timeSinceSeekEnd > 10000 OR timeSinceSeekEnd is NULL) AND isBackgroundEvent is false) + filter(sum(timeSinceBufferBegin/1000), where playerName = 'NexPlayer' and actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and timeSinceStarted > 10000)) / (filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END' AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000) - filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END'AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true)) + filter(count(*), where playerName ='NexPlayer' and actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and timeSinceStarted > 10000)) as 'seconds' where trackerName != 'TimeSliceTracker' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'small',
          chartType: 'billboard',
          title: 'Average Buffer Length',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT (filter(sum(timeSinceBufferBegin/1000), where playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END'and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 AND (timeSinceResumed > 10000 OR timeSinceResumed IS NULL) AND (timeSinceSeekEnd > 10000 OR timeSinceSeekEnd is NULL) AND isBackgroundEvent is false) + filter(sum(timeSinceBufferBegin/1000), where playerName = 'NexPlayer' and actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and timeSinceStarted > 10000)) / (filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END' AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000) - filter(count(*), WHERE playerName != 'NexPlayer' and actionName = 'CONTENT_BUFFER_END'AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true)) + filter(count(*), where playerName ='NexPlayer' and actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and timeSinceStarted > 10000)) as 'seconds' where trackerName != 'TimeSliceTracker' TIMESERIES `,
          columnStart: 4,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'Average Buffer Length Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(timeSinceBufferBegin/1000), WHERE playerName !='NexPlayer' and actionName = 'CONTENT_BUFFER_END' AND bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000) - filter(sum(timeSinceBufferBegin/1000), where bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 and (timeSinceResumed < 10000 or timeSinceSeekEnd < 10000 or isBackgroundEvent is true))+ filter(sum(timeSinceBufferBegin/1000), where playerName = 'NexPlayer' and actionName = 'CONTENT_BUFFER_END' and bufferType = 'connection' and timeSinceStarted > 10000) as 'seconds' TIMESERIES `,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Total Buffer Seconds Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(rate(count(*), 1 minute), where (playerName != 'NexPlayer' and bufferType = 'connection' and actionName = 'CONTENT_BUFFER_END' and timeSinceStarted > 10000 and timeSinceBufferBegin < 90000 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false)) OR (playerName = 'NexPlayer' and bufferType = 'connection' and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) as 'Buffer Event Rate/Min' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'small',
          chartType: 'billboard',
          title: 'Buffer Rate/Min',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(rate(count(*), 1 minute), where (playerName != 'NexPlayer' and bufferType = 'connection' and actionName = 'CONTENT_BUFFER_END' and timeSinceStarted > 10000 and timeSinceBufferBegin < 90000 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false)) OR (playerName = 'NexPlayer' and bufferType = 'connection' and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) as 'Buffer Event Rate/Min' TIMESERIES `,
          columnStart: 4,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'Buffer Rate/Min Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(rate(count(*), 1 minute), where (playerName != 'NexPlayer' and bufferType = 'connection' and actionName = 'CONTENT_BUFFER_END' and timeSinceStarted > 10000 and timeSinceBufferBegin < 90000 AND (timeSinceResumed IS NULL or timeSinceResumed > 10000 or timeSinceSeekEnd is NULL or timeSinceSeekEnd > 10000 or isBackgroundEvent is false)) OR (playerName = 'NexPlayer' and bufferType = 'connection' and timeSinceStarted > 10000 and actionName = 'CONTENT_BUFFER_END')) as 'Buffer Event Rate/Min' limit 200 facet viewId`,
          noFacet: true,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'bar',
          title: 'viewIds with high Buffer per min (Click for details)',
          useSince: true,
          click: 'openSession',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT actionName, bufferType, timeSinceBufferBegin, timeSinceStarted, assetId, assetName, ${USER_IDENTIFIER}, userId, appName, appVersion, capiProvider, immersiveActiveCamera, city, regionCode, asnOrganization, asnOwner, deviceModel, osName, osVersion, playerName, playerVersion, userAgentOS, userAgentName where playerName ='NexPlayer' and actionName = 'CONTENT_BUFFER_END'and bufferType = 'connection' and timeSinceStarted > 10000 limit MAX where trackerName != 'TimeSliceTracker' `,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'large',
          chartType: 'table',
          title: 'CIRR Buffer Multiview Events',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT actionName, bufferType, timeSinceBufferBegin, timeSinceSeekEnd, timeSinceStarted, timeSinceResumed, assetId, assetName, ${USER_IDENTIFIER}, userId, appName, appVersion, capiProvider, city, regionCode, asnOrganization, asnOwner, deviceModel, osName, osVersion, playerName, playerVersion, userAgentOS, userAgentName where playerName !='NexPlayer' and actionName = 'CONTENT_BUFFER_END'and bufferType = 'connection' and timeSinceBufferBegin < 90000 and timeSinceStarted > 10000 AND (timeSinceResumed > 10000 OR timeSinceResumed IS NULL) AND (timeSinceSeekEnd > 10000 OR timeSinceSeekEnd is NULL) AND isBackgroundEvent is false limit MAX where trackerName != 'TimeSliceTracker' `,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'large',
          chartType: 'table',
          title: 'CIRR Buffer VIDI Events',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT * where actionName != 'CONTENT_HEARTBEAT' where trackerName != 'TimeSliceTracker' LIMIT MAX`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'table',
          title: 'All Video Events',
          useSince: true,
        },
      ],
    },
    {
      id: 'BR-Detail',
      config: [
        {
          nrql: `SELECT sum(bitrate) / sum(number) as 'mbps' from (select (filter(sum(MobileVideo.contentBitrate)/1000/1000, where appName like '%iOS%' or appName like '%tvOS%') + filter(sum(MobileVideo.contentBitrate)/1000/1000, where appName like '%Android%') + filter(sum(PageAction.contentRenditionBitrate)/1000/1000, where appName like 'Crave%')) as 'bitrate', count(*) as 'number' FROM ${VIDEO_EVENTS} facet appVersion) `,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'billboard',
          title: 'Avg Bitrate',
          useSince: true,
        },
        {
          nrql: `SELECT sum(bitrate) / sum(number) as 'mbps' from (select (filter(sum(MobileVideo.contentBitrate)/1000/1000, where appName like '%iOS%' or appName like '%tvOS%') + filter(sum(MobileVideo.contentBitrate)/8/1000/1000, where appName like '%Android%') + filter(sum(PageAction.contentRenditionBitrate)/1000/1000, where appName like 'Crave%')) as 'bitrate', count(*) as 'number' FROM ${VIDEO_EVENTS} timeseries) TIMESERIES `,
          noFacet: 'true',
          columnStart: 5,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Bitrate Trend',
          useSince: true,
        },
        {
          nrql: `SELECT sum(bitrate) / sum(number) as 'mbps' from (select (filter(sum(MobileVideo.contentBitrate)/1000/1000, where appName like '%iOS%' or appName like '%tvOS%') + filter(sum(MobileVideo.contentBitrate)/8/1000/1000, where appName like '%Android%') + filter(sum(PageAction.contentRenditionBitrate)/1000/1000, where appName like 'Crave%')) as 'bitrate', count(*) as 'number' FROM ${VIDEO_EVENTS} facet deviceType, streamFormat, userAgentName, userAgentOS, appName, appVersion limit max ) limit 200 facet appName`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'bar',
          title: 'Avg Bitrate by App',
          useSince: true,
        },
        {
          nrql: `SELECT sum(bitrate) / sum(number) as 'mbps' from (select (filter(sum(MobileVideo.contentBitrate)/1000/1000, where appName like '%iOS%' or appName like '%tvOS%') + filter(sum(MobileVideo.contentBitrate)/8/1000/1000, where appName like '%Android%') + filter(sum(PageAction.contentRenditionBitrate)/1000/1000, where appName like 'Crave%')) as 'bitrate', count(*) as 'number' FROM ${VIDEO_EVENTS} facet appName timeseries limit max ) limit 200 facet appName TIMESERIES `,
          noFacet: 'true',
          columnStart: 5,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Bitrate by App Trend',
          useSince: true,
        },
      ],
    },
    {
      id: 'FPS-Detail',
      config: [
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'FPS' `,
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Avg FPS',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(droppedFrames), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'Frame Drops' `,
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Total Frame Drops',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) as 'Plays' where totalPlaytime > 1000 and trackerName = 'TimeSliceTracker' `,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Total Plays',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'FPS' TIMESERIES `,
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'line',
          title: 'Avg FPS Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(droppedFrames), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'Frame Drops' TIMESERIES `,
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'line',
          title: 'Total Frame Drops Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) as 'Active Plays' where totalPlaytime > 1000 and trackerName = 'TimeSliceTracker' TIMESERIES `,
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'line',
          title: 'Peak Views',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(rate(count(*), 1 minute), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'Frame Drop Rate/Min' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Frame Drop Rate/Min',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(sum(droppedFrames), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0)/filter(count(*),where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'AVG Frame Drops/Event' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Avg Frame Drops per Event',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(rate(count(*), 1 minute), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'Frame Drop Rate/Min', filter(sum(droppedFrames), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0)/filter(count(*),where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 0) as 'AVG Frame drops per event' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'Frame Drop Rate Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20) as 'W/ FPS < 20' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'FPS Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60) as 'W/ Drop Frames > 10' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Drop Frame Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20) as 'FPS < 20 Impacted Customers', filter(uniqueCount(${USER_IDENTIFIER}), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60) as 'Drop Frames > 10 Impacted Customers' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'Impacted Customer Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20)/filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as '% w/ FPS < 20' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'FPS % Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60)/filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as '% w/ Frame Drop > 10' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Drop Frame % Customer Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20)/filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as 'FPS < 20 Impacted customer %', filter(uniqueCount(${USER_IDENTIFIER}), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60)/filter(uniqueCount(${USER_IDENTIFIER}), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as 'Frame Drop > 10 Impacted Customer %' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'Customer Impact % Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20) as 'W/ FPS < 20' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'FPS Views Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60) as 'W/ Drop Frames > 10' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Drop Frame Views Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20) as 'FPS < 20 Impacted Views', filter(uniqueCount(viewId), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60) as 'Drop Frames > 10 Impacted Views' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'Views Impacted Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20)/filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as '% w/ FPS < 20' `,
          columnStart: 1,
          columnEnd: 3,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'FPS % Views Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60)/filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as '% w/ Frame Drop > 10' `,
          columnStart: 4,
          columnEnd: 6,
          chartSize: 'micro',
          chartType: 'billboard',
          title: 'Drop Frame % Views Impact',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20)/filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as 'FPS < 20 Impacted Views %', filter(uniqueCount(viewId), where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60)/filter(uniqueCount(viewId), where trackerName = 'TimeSliceTracker' and totalPlaytime > 1000)*100 as 'Frame Drop > 10 Impacted Views %' TIMESERIES `,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'micro',
          chartType: 'line',
          title: 'Views Impact % Trend',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
          facets: 'appName',
          columnStart: 1,
          columnEnd: 4,
          chartSize: 'small',
          chartType: 'area',
          title: 'Average FPS Trend by App',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
          facets: 'city, regionCode',
          columnStart: 5,
          columnEnd: 8,
          chartSize: 'small',
          chartType: 'area',
          title: 'Average FPS Trend by City/Region Code',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
          facets: 'asnOwner,asnOrganization',
          columnStart: 9,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Average FPS Trend by ISP Owner/Org',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT filter(average(contentFps), where trackerName = 'TimeSliceTracker' and contentFps != 0) as 'Avg FPS' TIMESERIES LIMIT 25 `,
          facets: 'assetName',
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'area',
          title: 'Average FPS Trend by Asset Name',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT average(contentFps) where contentFps != 0 and trackerName = 'TimeSliceTracker' TIMESERIES LIMIT 25 `,
          facets: 'capiProvider',
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'area',
          title: 'Average FPS Trend by Video Domain',
          useSince: true,
          // click: 'doNothing',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) where trackerName = 'TimeSliceTracker' and contentFps != 0 and contentFps < 20 facet viewId LIMIT 200`,
          noFacet: true,
          columnStart: 1,
          columnEnd: 6,
          chartSize: 'small',
          chartType: 'bar',
          title: 'FPS < 20 by viewId (Click for details)',
          useSince: true,
          click: 'openSession',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT uniqueCount(viewId) where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames > 10 and droppedFrames < 60 facet viewId LIMIT 200`,
          noFacet: true,
          columnStart: 7,
          columnEnd: 12,
          chartSize: 'small',
          chartType: 'bar',
          title: 'Frame Drop > 10 by viewId (Click for details)',
          useSince: true,
          click: 'openSession',
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT timestamp, userAisuid, userId, actionName, contentFps, assetName, immersiveActiveCamera, appName, appVersion, asnOwner, city, regionCode, countryCode, device where contentFps < 20 and contentFps != 0 and trackerName = 'TimeSliceTracker' LIMIT MAX`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'table',
          title: 'Low Frame Rate Events Log',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT timestamp, userAisuid, userId, actionName, contentFps, droppedFrames, assetName, immersiveActiveCamera, appName, appVersion, asnOwner, city, regionCode, countryCode, device, networkType, carrier where actionName IN ('CONTENT_DROPPED_FRAMES', 'CONTENT_DROP_FRAMES') and trackerName = 'TimeSliceTracker' and droppedFrames < 60 and droppedFrames > 5 LIMIT MAX`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'table',
          title: 'Dropped Frames Events Log',
          useSince: true,
        },
        {
          nrql: `FROM ${VIDEO_EVENTS} SELECT * where actionName != 'CONTENT_HEARTBEAT' LIMIT 1000`,
          noFacet: 'true',
          columnStart: 1,
          columnEnd: 12,
          chartSize: 'medium',
          chartType: 'table',
          title: 'All Video Events Log',
          useSince: true,
        },
      ],
    },
  ],
  qualityScore: {
    include: ['VSF', 'VST', 'CRR', 'ER'],
    formula: metrics => {
      const vsf = defaultToOne(metrics.VSF)
      const rest =
        (defaultToOne(metrics.VST) +
        1 + // defaultToOne(metrics.CI) +
          defaultToOne(metrics.CRR) +
          defaultToOne(metrics.ER)) *
        25
      return vsf * rest
    },
    threshold: {
      critical: 80,
      warning: 90,
      type: 'below',
    },
  },
}
